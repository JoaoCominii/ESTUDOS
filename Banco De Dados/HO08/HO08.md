# HO08
## ENUNCIADO:

Especificar as seguintes consultas em SQL para recuperar os dados em um banco de dados relacional, considerando o conjunto de dados (dataset) denominado IMDB-sample disponível na calculadora RelaX

## 1. Projetar o primeiro nome e o último nome dos atores que são diretores;
```sql
SELECT first_name, last_name
FROM actors
INTERSECT
SELECT first_name, last_name
FROM directors
```

## 2. Projetar o primeiro nome e o último nome dos atores que não são diretores;
```sql
SELECT first_name, last_name
FROM actors
EXCEPT
SELECT first_name, last_name
FROM directors
```

## 3. Projetar o primeiro nome e o último nome dos atores e diretores;
```sql
SELECT first_name, last_name
FROM actors
UNION
SELECT first_name, last_name
FROM directors
```

## 4. Projetar o nome dos filmes que não são dirigidos por nenhum diretor;
```sql
SELECT X.name
FROM movies as X JOIN (
    SELECT A.id
    FROM movies as A
    EXCEPT
    SELECT B.movie_id
    FROM movies_directors as B
) as Y ON X.id = Y.id
```

## 5. Projetar primeiro nome e o último nome dos atores que não atuaram em pelo menos dois filmes;
```sql
SELECT X.first_name, X.last_name
FROM actors as X JOIN (
    SELECT id
    FROM actors
    EXCEPT
    SELECT A.actor_id
    FROM (
        SELECT actor_id, COUNT(*) as TOTAL
        FROM roles
        GROUP BY actor_id
        HAVING TOTAL >= 2
    ) as A
) as Y ON X.id = Y.id
```

## 6. Projetar, por gênero e ano, o número de filmes com menos de dois atores atuando.
```sql
SELECT X.genre, K.year, COUNT(*) as TOTAL
FROM movies_genres as X JOIN (
    SELECT id
    FROM movies
    EXCEPT
    SELECT A.movie_id
    FROM (
        SELECT movie_id, COUNT(*) as TOTAL
        FROM roles
        GROUP BY movie_id
        HAVING TOTAL >= 2
    ) as A
) as Y ON X.movie_id = Y.id
JOIN movies as K ON (K.id = Y.id)
GROUP BY X.genre, K.year
```


